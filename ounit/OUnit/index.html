<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OUnit (ounit.OUnit)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ounit</a> &#x00BB; OUnit</nav><h1>Module <code>OUnit</code></h1><p>Unit test building blocks</p><dl><dt>author</dt><dd>Maas-Maarten Zeeman</dd></dl><dl><dt>author</dt><dd>Sylvain Le Gall</dd></dl><nav class="toc"><ul><li><a href="#assertions">Assertions</a></li><li><a href="#skipping-tests">Skipping tests</a></li><li><a href="#compare-functions">Compare Functions</a></li><li><a href="#bracket">Bracket</a></li><li><a href="#constructing-tests">Constructing Tests</a></li><li><a href="#retrieve-information-from-tests">Retrieve Information from Tests</a></li><li><a href="#performing-tests">Performing Tests</a></li></ul></nav></header><section><header><h3 id="assertions"><a href="#assertions" class="anchor"></a>Assertions</h3><p>Assertions are the basic building blocks of unittests.</p></header><dl><dt class="spec value" id="val-assert_failure"><a href="#val-assert_failure" class="anchor"></a><code><span class="keyword">val</span> assert_failure : string <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Signals a failure. This will raise an exception with the specified string.</p><dl><dt>raises Failure</dt><dd><p>signal a failure</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-assert_bool"><a href="#val-assert_bool" class="anchor"></a><code><span class="keyword">val</span> assert_bool : string <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> unit</code></dt><dd><p>Signals a failure when bool is false. The string identifies the failure.</p><dl><dt>raises Failure</dt><dd><p>signal a failure</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-(@?)"><a href="#val-(@?)" class="anchor"></a><code><span class="keyword">val</span> (@?) : string <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> unit</code></dt><dd><p>Shorthand for assert_bool</p><dl><dt>raises Failure</dt><dd><p>to signal a failure</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-assert_string"><a href="#val-assert_string" class="anchor"></a><code><span class="keyword">val</span> assert_string : string <span>&#45;&gt;</span> unit</code></dt><dd><p>Signals a failure when the string is non-empty. The string identifies the failure.</p><dl><dt>raises Failure</dt><dd><p>signal a failure</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-assert_command"><a href="#val-assert_command" class="anchor"></a><code><span class="keyword">val</span> assert_command : <span>?&#8288;exit_code:Unix.process_status</span> <span>&#45;&gt;</span> <span>?&#8288;sinput:<span>char Stdlib.Stream.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;foutput:<span>(<span>char Stdlib.Stream.t</span> <span>&#45;&gt;</span> unit)</span></span> <span>&#45;&gt;</span> <span>?&#8288;use_stderr:bool</span> <span>&#45;&gt;</span> <span>?&#8288;env:<span>string array</span></span> <span>&#45;&gt;</span> <span>?&#8288;verbose:bool</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>string list</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>assert_command prg args</code> Run the command provided.</p><dl><dt>parameter exit_code</dt><dd><p>expected exit code</p></dd></dl><dl><dt>parameter sinput</dt><dd><p>provide this <code>char Stream.t</code> as input of the process</p></dd></dl><dl><dt>parameter foutput</dt><dd><p>run this function on output, it can contains an <code>assert_equal</code> to check it</p></dd></dl><dl><dt>parameter use_stderr</dt><dd><p>redirect <code>stderr</code> to <code>stdout</code></p></dd></dl><dl><dt>parameter env</dt><dd><p>Unix environment</p></dd></dl><dl><dt>parameter verbose</dt><dd><p>if failed, dump stdout/stderr of the process to stderr</p></dd></dl><dl><dt>since</dt><dd>1.1.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-assert_equal"><a href="#val-assert_equal" class="anchor"></a><code><span class="keyword">val</span> assert_equal : <span>?&#8288;cmp:<span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;printer:<span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> string)</span></span> <span>&#45;&gt;</span> <span>?&#8288;pp_diff:<span>(Stdlib.Format.formatter <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> * <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> unit)</span></span> <span>&#45;&gt;</span> <span>?&#8288;msg:string</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>assert_equal expected real</code> Compares two values, when they are not equal a failure is signaled.</p><dl><dt>parameter cmp</dt><dd><p>customize function to compare, default is <code>=</code></p></dd></dl><dl><dt>parameter printer</dt><dd><p>value printer, don't print value otherwise</p></dd></dl><dl><dt>parameter pp_diff</dt><dd><p>if not equal, ask a custom display of the difference using <code>diff fmt exp real</code> where <code>fmt</code> is the formatter to use</p></dd></dl><dl><dt>parameter msg</dt><dd><p>custom message to identify the failure</p></dd></dl><dl><dt>raises Failure</dt><dd><p>signal a failure</p></dd></dl><dl><dt>version</dt><dd>1.1.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-assert_raises"><a href="#val-assert_raises" class="anchor"></a><code><span class="keyword">val</span> assert_raises : <span>?&#8288;msg:string</span> <span>&#45;&gt;</span> exn <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Asserts if the expected exception was raised.</p><dl><dt>parameter msg</dt><dd><p>identify the failure</p></dd></dl><dl><dt>raises Failure</dt><dd><p>description</p></dd></dl></dd></dl></section><section><header><h3 id="skipping-tests"><a href="#skipping-tests" class="anchor"></a>Skipping tests</h3><p>In certain condition test can be written but there is no point running it, because they are not significant (missing OS features for example). In this case this is not a failure nor a success. Following functions allow you to escape test, just as assertion but without the same error status.</p><p>A test skipped is counted as success. A test todo is counted as failure.</p></header><dl><dt class="spec value" id="val-skip_if"><a href="#val-skip_if" class="anchor"></a><code><span class="keyword">val</span> skip_if : bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>skip cond msg</code> If <code>cond</code> is true, skip the test for the reason explain in <code>msg</code>. For example <code>skip_if (Sys.os_type = &quot;Win32&quot;) &quot;Test a doesn't run on
    windows&quot;</code>.</p><dl><dt>since</dt><dd>1.0.3</dd></dl></dd></dl><dl><dt class="spec value" id="val-todo"><a href="#val-todo" class="anchor"></a><code><span class="keyword">val</span> todo : string <span>&#45;&gt;</span> unit</code></dt><dd><p>The associated test is still to be done, for the reason given.</p><dl><dt>since</dt><dd>1.0.3</dd></dl></dd></dl></section><section><header><h3 id="compare-functions"><a href="#compare-functions" class="anchor"></a>Compare Functions</h3></header><dl><dt class="spec value" id="val-cmp_float"><a href="#val-cmp_float" class="anchor"></a><code><span class="keyword">val</span> cmp_float : <span>?&#8288;epsilon:float</span> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> bool</code></dt><dd><p>Compare floats up to a given relative error.</p><dl><dt>parameter epsilon</dt><dd><p>if the difference is smaller <code>epsilon</code> values are equal</p></dd></dl></dd></dl></section><section><header><h3 id="bracket"><a href="#bracket" class="anchor"></a>Bracket</h3><p>A bracket is a functional implementation of the commonly used setUp and tearDown feature in unittests. It can be used like this:</p><p><code>&quot;MyTestCase&quot; &gt;:: (bracket test_set_up test_fun test_tear_down)</code></p></header><dl><dt class="spec value" id="val-bracket"><a href="#val-bracket" class="anchor"></a><code><span class="keyword">val</span> bracket : <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>bracket set_up test tear_down</code> The <code>set_up</code> function runs first, then the <code>test</code> function runs and at the end <code>tear_down</code> runs. The <code>tear_down</code> function runs even if the <code>test</code> failed and help to clean the environment.</p></dd></dl><dl><dt class="spec value" id="val-bracket_tmpfile"><a href="#val-bracket_tmpfile" class="anchor"></a><code><span class="keyword">val</span> bracket_tmpfile : <span>?&#8288;prefix:string</span> <span>&#45;&gt;</span> <span>?&#8288;suffix:string</span> <span>&#45;&gt;</span> <span>?&#8288;mode:<span>Stdlib.open_flag list</span></span> <span>&#45;&gt;</span> <span>(<span>(string * Stdlib.out_channel)</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>bracket_tmpfile test</code> The <code>test</code> function takes a temporary filename and matching output channel as arguments. The temporary file is created before the test and removed after the test.</p><dl><dt>parameter prefix</dt><dd><p>see <code>Filename.open_temp_file</code></p></dd></dl><dl><dt>parameter suffix</dt><dd><p>see <code>Filename.open_temp_file</code></p></dd></dl><dl><dt>parameter mode</dt><dd><p>see <code>Filename.open_temp_file</code></p></dd></dl><dl><dt>since</dt><dd>1.1.0</dd></dl></dd></dl></section><section><header><h3 id="constructing-tests"><a href="#constructing-tests" class="anchor"></a>Constructing Tests</h3></header><dl><dt class="spec type" id="type-test_fun"><a href="#type-test_fun" class="anchor"></a><code><span class="keyword">type</span> test_fun</code><code> = unit <span>&#45;&gt;</span> unit</code></dt><dd><p>The type of test function</p></dd></dl><dl><dt class="spec type" id="type-test"><a href="#type-test" class="anchor"></a><code><span class="keyword">type</span> test</code><code> = </code><table class="variant"><tr id="type-test.TestCase" class="anchored"><td class="def constructor"><a href="#type-test.TestCase" class="anchor"></a><code>| </code><code><span class="constructor">TestCase</span> <span class="keyword">of</span> <a href="index.html#type-test_fun">test_fun</a></code></td></tr><tr id="type-test.TestList" class="anchored"><td class="def constructor"><a href="#type-test.TestList" class="anchor"></a><code>| </code><code><span class="constructor">TestList</span> <span class="keyword">of</span> <span><a href="index.html#type-test">test</a> list</span></code></td></tr><tr id="type-test.TestLabel" class="anchored"><td class="def constructor"><a href="#type-test.TestLabel" class="anchor"></a><code>| </code><code><span class="constructor">TestLabel</span> <span class="keyword">of</span> string * <a href="index.html#type-test">test</a></code></td></tr></table></dt><dd><p>The type of tests</p></dd></dl><dl><dt class="spec value" id="val-(&gt;:)"><a href="#val-(&gt;:)" class="anchor"></a><code><span class="keyword">val</span> (&gt;:) : string <span>&#45;&gt;</span> <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a></code></dt><dd><p>Create a TestLabel for a test</p></dd></dl><dl><dt class="spec value" id="val-(&gt;::)"><a href="#val-(&gt;::)" class="anchor"></a><code><span class="keyword">val</span> (&gt;::) : string <span>&#45;&gt;</span> <a href="index.html#type-test_fun">test_fun</a> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a></code></dt><dd><p>Create a TestLabel for a TestCase</p></dd></dl><dl><dt class="spec value" id="val-(&gt;:::)"><a href="#val-(&gt;:::)" class="anchor"></a><code><span class="keyword">val</span> (&gt;:::) : string <span>&#45;&gt;</span> <span><a href="index.html#type-test">test</a> list</span> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a></code></dt><dd><p>Create a TestLabel for a TestList</p></dd></dl><aside><p>Some shorthands which allows easy test construction.</p><p>Examples:</p><ul><li><code>&quot;test1&quot; &gt;: TestCase((fun _ -&gt; ()))</code> =&gt; <code>TestLabel(&quot;test2&quot;, TestCase((fun _ -&gt; ())))</code></li><li><code>&quot;test2&quot; &gt;:: (fun _ -&gt; ())</code> =&gt; <code>TestLabel(&quot;test2&quot;, TestCase((fun _ -&gt; ())))</code></li><li><code>&quot;test-suite&quot; &gt;::: [&quot;test2&quot; &gt;:: (fun _ -&gt; ());]</code> =&gt; <code>TestLabel(&quot;test-suite&quot;, TestSuite([TestLabel(&quot;test2&quot;,
                                       TestCase((fun _ -&gt; ())))]))</code></li></ul></aside><dl><dt class="spec value" id="val-test_decorate"><a href="#val-test_decorate" class="anchor"></a><code><span class="keyword">val</span> test_decorate : <span>(<a href="index.html#type-test_fun">test_fun</a> <span>&#45;&gt;</span> <a href="index.html#type-test_fun">test_fun</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a></code></dt><dd><p><code>test_decorate g tst</code> Apply <code>g</code> to test function contains in <code>tst</code> tree.</p><dl><dt>since</dt><dd>1.0.3</dd></dl></dd></dl><dl><dt class="spec value" id="val-test_filter"><a href="#val-test_filter" class="anchor"></a><code><span class="keyword">val</span> test_filter : <span>?&#8288;skip:bool</span> <span>&#45;&gt;</span> <span>string list</span> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <span><a href="index.html#type-test">test</a> option</span></code></dt><dd><p><code>test_filter paths tst</code> Filter test based on their path string representation.</p><dl><dt>parameter skip</dt><dd><p>if set, just use <code>skip_if</code> for the matching tests.</p></dd></dl><dl><dt>since</dt><dd>1.0.3</dd></dl></dd></dl></section><section><header><h3 id="retrieve-information-from-tests"><a href="#retrieve-information-from-tests" class="anchor"></a>Retrieve Information from Tests</h3></header><dl><dt class="spec value" id="val-test_case_count"><a href="#val-test_case_count" class="anchor"></a><code><span class="keyword">val</span> test_case_count : <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Returns the number of available test cases</p></dd></dl><dl><dt class="spec type" id="type-node"><a href="#type-node" class="anchor"></a><code><span class="keyword">type</span> node</code><code> = </code><table class="variant"><tr id="type-node.ListItem" class="anchored"><td class="def constructor"><a href="#type-node.ListItem" class="anchor"></a><code>| </code><code><span class="constructor">ListItem</span> <span class="keyword">of</span> int</code></td></tr><tr id="type-node.Label" class="anchored"><td class="def constructor"><a href="#type-node.Label" class="anchor"></a><code>| </code><code><span class="constructor">Label</span> <span class="keyword">of</span> string</code></td></tr></table></dt><dd><p>Types which represent the path of a test</p></dd></dl><dl><dt class="spec type" id="type-path"><a href="#type-path" class="anchor"></a><code><span class="keyword">type</span> path</code><code> = <span><a href="index.html#type-node">node</a> list</span></code></dt><dd><p>The path to the test (in reverse order).</p></dd></dl><dl><dt class="spec value" id="val-string_of_node"><a href="#val-string_of_node" class="anchor"></a><code><span class="keyword">val</span> string_of_node : <a href="index.html#type-node">node</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Make a string from a node</p></dd></dl><dl><dt class="spec value" id="val-string_of_path"><a href="#val-string_of_path" class="anchor"></a><code><span class="keyword">val</span> string_of_path : <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Make a string from a path. The path will be reversed before it is tranlated into a string</p></dd></dl><dl><dt class="spec value" id="val-test_case_paths"><a href="#val-test_case_paths" class="anchor"></a><code><span class="keyword">val</span> test_case_paths : <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <span><a href="index.html#type-path">path</a> list</span></code></dt><dd><p>Returns a list with paths of the test</p></dd></dl></section><section><header><h3 id="performing-tests"><a href="#performing-tests" class="anchor"></a>Performing Tests</h3></header><dl><dt class="spec type" id="type-test_result"><a href="#type-test_result" class="anchor"></a><code><span class="keyword">type</span> test_result</code><code> = </code><table class="variant"><tr id="type-test_result.RSuccess" class="anchored"><td class="def constructor"><a href="#type-test_result.RSuccess" class="anchor"></a><code>| </code><code><span class="constructor">RSuccess</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a></code></td></tr><tr id="type-test_result.RFailure" class="anchored"><td class="def constructor"><a href="#type-test_result.RFailure" class="anchor"></a><code>| </code><code><span class="constructor">RFailure</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a> * string</code></td></tr><tr id="type-test_result.RError" class="anchored"><td class="def constructor"><a href="#type-test_result.RError" class="anchor"></a><code>| </code><code><span class="constructor">RError</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a> * string</code></td></tr><tr id="type-test_result.RSkip" class="anchored"><td class="def constructor"><a href="#type-test_result.RSkip" class="anchor"></a><code>| </code><code><span class="constructor">RSkip</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a> * string</code></td></tr><tr id="type-test_result.RTodo" class="anchored"><td class="def constructor"><a href="#type-test_result.RTodo" class="anchor"></a><code>| </code><code><span class="constructor">RTodo</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a> * string</code></td></tr></table></dt><dd><p>The possible results of a test</p></dd></dl><dl><dt class="spec type" id="type-test_event"><a href="#type-test_event" class="anchor"></a><code><span class="keyword">type</span> test_event</code><code> = </code><table class="variant"><tr id="type-test_event.EStart" class="anchored"><td class="def constructor"><a href="#type-test_event.EStart" class="anchor"></a><code>| </code><code><span class="constructor">EStart</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a></code></td><td class="doc"><p>A test start.</p></td></tr><tr id="type-test_event.EEnd" class="anchored"><td class="def constructor"><a href="#type-test_event.EEnd" class="anchor"></a><code>| </code><code><span class="constructor">EEnd</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a></code></td><td class="doc"><p>A test end.</p></td></tr><tr id="type-test_event.EResult" class="anchored"><td class="def constructor"><a href="#type-test_event.EResult" class="anchor"></a><code>| </code><code><span class="constructor">EResult</span> <span class="keyword">of</span> <a href="index.html#type-test_result">test_result</a></code></td><td class="doc"><p>Result of a test.</p></td></tr></table></dt><dd><p>Events which occur during a test run.</p></dd></dl><dl><dt class="spec type" id="type-test_results"><a href="#type-test_results" class="anchor"></a><code><span class="keyword">type</span> test_results</code><code> = <span><a href="index.html#type-test_result">test_result</a> list</span></code></dt><dd><p>Results of a test run.</p></dd></dl><dl><dt class="spec value" id="val-perform_test"><a href="#val-perform_test" class="anchor"></a><code><span class="keyword">val</span> perform_test : <span>(<a href="index.html#type-test_event">test_event</a> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <a href="index.html#type-test_results">test_results</a></code></dt><dd><p>Perform the test, allows you to build your own test runner</p></dd></dl><dl><dt class="spec value" id="val-run_test_tt"><a href="#val-run_test_tt" class="anchor"></a><code><span class="keyword">val</span> run_test_tt : <span>?&#8288;verbose:bool</span> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <a href="index.html#type-test_results">test_results</a></code></dt><dd><p>A simple text based test runner.</p><dl><dt>parameter verbose</dt><dd><p>print verbose message</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-run_test_tt_main"><a href="#val-run_test_tt_main" class="anchor"></a><code><span class="keyword">val</span> run_test_tt_main : <span>?&#8288;arg_specs:<span><span>(Stdlib.Arg.key * Stdlib.Arg.spec * Stdlib.Arg.doc)</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;set_verbose:<span>(bool <span>&#45;&gt;</span> unit)</span></span> <span>&#45;&gt;</span> <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <a href="index.html#type-test_results">test_results</a></code></dt><dd><p>Main version of the text based test runner. It reads the supplied command line arguments to set the verbose level and limit the number of test to run.</p><dl><dt>parameter arg_specs</dt><dd><p>add extra command line arguments</p></dd></dl><dl><dt>parameter set_verbose</dt><dd><p>call a function to set verbosity</p></dd></dl><dl><dt>parameter fexit</dt><dd><p>call a final function after test, by default exit 1.</p></dd></dl><dl><dt>version</dt><dd>1.1.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-ounit2_of_ounit1"><a href="#val-ounit2_of_ounit1" class="anchor"></a><code><span class="keyword">val</span> ounit2_of_ounit1 : <a href="index.html#type-test">test</a> <span>&#45;&gt;</span> <a href="../OUnit2/index.html#type-test">OUnit2.test</a></code></dt></dl></section></div></body></html>